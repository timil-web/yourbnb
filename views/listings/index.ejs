<% layout("/layouts/boilerplate") %>

<style>
	a{
		text-decoration: none;
		color: black;
	}
	#filters{
		display: flex;
		flex-wrap: wrap;
		align-items: center;
	}
	.filter{
		text-align: center;
		margin-right: 2rem;
		margin-top: 2rem;
		opacity: 0.7;
	}
	.filter:hover{
		opacity: 1;
		cursor: pointer;
	}
	.filter p{
		font-size: 0.8rem;
	}
	.tax-toggle{
		border: 1px solid black;
		border-radius: 1rem;
		height: 3.25rem;
		padding: 1rem;
		margin-left: 2rem;
		display: flex;
		align-items: center;
	}
	.tax-info{
		display: none;
	}
	@media (max-width: 1024px) {
		#filters {
			flex-wrap: wrap;
			justify-content: space-evenly;
		}
		.filter {
			flex: 1 1 20%;
			margin: 1rem;
		}
	}

	@media (max-width: 768px) {
		#filters {
			justify-content: center;
		}

		.filter {
			margin-right: 1rem;
			margin-top: 1rem;
			flex: 1 1 30%; /* 3 per row roughly */
		}

		.filter p {
			font-size: 0.7rem;
		}

		.tax-toggle {
			width: 100%;
			text-align: center;
			margin-top: 1.5rem;
			justify-content: center;
		}
	}

	@media (max-width: 480px) {
		#filters {
			flex-direction: column;
			align-items: center;
		}
		.filter {
			flex: 1 1 90%;
			margin: 0.5rem 0;
		}

		.filter p {
			font-size: 0.65rem;
			text-align: center;
		}

		.tax-toggle {
			width: 90%;
			margin-top: 1rem;
			padding: 0.5rem;
		}
	}

</style>

<div id="filters" class="container-fluid">
  <a href="/listings/category/Trending" class="filter">
	<div><i class="fa-solid fa-fire"></i></div>
	<p>Trending</p>
  </a>
  <a href="/listings/category/Room" class="filter">
	<div><i class="fa-solid fa-bed"></i></div>
	<p>Rooms</p>
  </a>
  <a href="/listings/category/Iconic%20Cities" class="filter">
	<div><i class="fa-solid fa-mountain-city"></i></div>
	<p>Iconic Cities</p>
  </a>
  <a href="/listings/category/Mountains" class="filter">
	<div><i class="fa-solid fa-mountain"></i></div>
	<p>Mountains</p>
  </a>
  <a href="/listings/category/Castles" class="filter">
	<div><i class="fa-brands fa-fort-awesome"></i></div>
	<p>Castles</p>
  </a>
  <a href="/listings/category/Amazing%20Pool" class="filter">
	<div><i class="fa-solid fa-person-swimming"></i></div>
	<p>Amazing Pool</p>
  </a>
  <a href="/listings/category/Camping" class="filter">
	<div><i class="fa-solid fa-campground"></i></div>
	<p>Camping</p>
  </a>
  <a href="/listings/category/Farms" class="filter">
	<div><i class="fa-solid fa-cow"></i></div>
	<p>Farms</p>
  </a>
  <a href="/listings/category/Arctic" class="filter">
	<div><i class="fa-solid fa-snowflake"></i></div>
	<p>Arctic</p>
  </a>
  <a href="/listings/category/Domes" class="filter">
	<div><i class="fa-solid fa-igloo"></i></div>
	<p>Domes</p>
  </a>
  <a href="/listings/category/Boats" class="filter">
	<div><i class="fa-solid fa-ship"></i></div>
	<p>Boats</p>
  </a>

  <div class="tax-toggle">
	<div class="form-check-reverse form-switch">
	<input 
	  class="form-check-input" 
	  type="checkbox" 
	  role="switch" 
	  id="switchCheckDefault">
	<label class="form-check-label" for="switchCheckDefault">
		Display Total after taxes
	</label>
	</div>
  </div>

</div>

<div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1 mt-3">
	<% for(let listing of allListings){ %>
	<a href="/listings/<%=listing._id%>" class="listing-link">
	<div class="card col listing-card">
		<img
			src="<%=listing.image.url%>" 
			class="card-img-top" 
			alt="listing_image" 
			style="height: 20rem;"
		>
		<div class="card-img-overlay"></div>
		<div class="card-body">
			<p class="card-text">
				<b> <%=listing.title%> </b><br>
				&#8377; <%= listing.price.toLocaleString("en-IN") %> / night
				<i class="tax-info"> &nbsp;+18% GST</i>
			</p>
		</div>
	</div>
	</a>
	<% } %>
</div>

<script>
	let taxSwitch = document.getElementById("switchCheckDefault");
	taxSwitch.addEventListener("click", () => {
		let taxInfo = document.querySelectorAll(".tax-info");
		for(info of taxInfo){
			if(info.style.display !== "inline"){
				info.style.display = "inline";
			} else {
				info.style.display = "none";
			}
		}
	})
</script>